{% extends "layouts/base.html" %}

{% block title %}Dividend Calculator | TST{% endblock %}

{% block content %}
<section class="section">
    <div class="container">

        <!-- Header -->
        <div class="text-center mb-xl">
            <div
                class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-surface border border-brand mb-md">
                <i class="bi bi-calculator text-brand text-2xl"></i>
            </div>
            <h1 class="h1 mb-sm">Dividend Calculator</h1>
            <p class="text-secondary">Calculate expected dividend income and yield</p>
        </div>

        <div class="grid grid-cols-2-md gap-xl">

            <!-- Parameters -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="bi bi-pencil-square me-sm"></i>Investment Details
                    </h3>
                </div>
                <form id="dividendForm">
                    <div class="mb-lg">
                        <label for="stockCode" class="text-secondary mb-xs block">Stock Code</label>
                        <input type="text" id="stockCode" name="stockCode" class="input font-mono"
                            placeholder="e.g. 2330" maxlength="10">
                    </div>

                    <div class="mb-lg">
                        <label for="shares" class="text-secondary mb-xs block">Shares Owned</label>
                        <input type="number" id="shares" name="shares" class="input font-mono" placeholder="1000"
                            min="1" required>
                    </div>

                    <div class="mb-lg">
                        <label for="dividend" class="text-secondary mb-xs block">Dividend Per Share (NT$)</label>
                        <input type="number" id="dividend" name="dividend" class="input font-mono" placeholder="3.5"
                            step="0.01" min="0" required>
                    </div>

                    <div class="mb-lg">
                        <label for="frequency" class="text-secondary mb-xs block">Frequency</label>
                        <select id="frequency" name="frequency" class="input" required>
                            <option value="1">Annually</option>
                            <option value="2">Semi-Annually</option>
                            <option value="4">Quarterly</option>
                            <option value="12">Monthly</option>
                        </select>
                    </div>

                    <div class="mb-xl">
                        <label for="years" class="text-secondary mb-xs block">Investment Period (Years)</label>
                        <input type="number" id="years" name="years" class="input font-mono" placeholder="5" min="1"
                            max="50" required>
                    </div>

                    <button type="submit" class="btn btn-primary w-full">
                        <i class="bi bi-calculator me-sm"></i>Calculate
                    </button>
                </form>
            </div>

            <!-- Results -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="bi bi-graph-up me-sm"></i>Results
                    </h3>
                </div>

                <div id="results" class="p-xl radius-md bg-surface border border-brand" style="display: none;">
                    <div class="text-center mb-xl">
                        <div class="text-secondary text-sm uppercase mb-xs">Expected Annual Income</div>
                        <div class="h1 font-mono text-brand mb-0" id="annualDividend">$0</div>
                        <div class="text-secondary text-sm">per year</div>
                    </div>

                    <div class="border-t border-color pt-lg">
                        <div class="flex justify-between items-center mb-md">
                            <span class="text-secondary">Total Period</span>
                            <span class="font-mono font-bold" id="totalYears">0 Years</span>
                        </div>
                        <div class="flex justify-between items-center mb-md">
                            <span class="text-secondary">Total Dividend Income</span>
                            <span class="font-mono font-bold text-up" id="totalDividend">$0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-secondary">Monthly Average</span>
                            <span class="font-mono font-bold" id="monthlyDividend">$0</span>
                        </div>
                    </div>
                </div>

                <div id="placeholder"
                    class="flex flex-col items-center justify-center h-full text-secondary opacity-50 py-xl">
                    <i class="bi bi-calculator text-4xl mb-md"></i>
                    <p>Enter details to calculate</p>
                </div>
            </div>

        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const form = document.getElementById('dividendForm');
        const results = document.getElementById('results');
        const placeholder = document.getElementById('placeholder');

        form.addEventListener('submit', function (e) {
            e.preventDefault();
            calculateDividend();
        });

        function calculateDividend() {
            const shares = parseFloat(document.getElementById('shares').value);
            const dividend = parseFloat(document.getElementById('dividend').value);
            const frequency = parseInt(document.getElementById('frequency').value);
            const years = parseInt(document.getElementById('years').value);

            if (!shares || !dividend || !frequency || !years) {
                alert('Please fill in all fields');
                return;
            }

            const annualDividend = shares * dividend * frequency;
            const totalDividend = annualDividend * years;
            const monthlyDividend = annualDividend / 12;

            document.getElementById('annualDividend').textContent =
                'NT$ ' + annualDividend.toLocaleString();
            document.getElementById('totalYears').textContent = years + ' Years';
            document.getElementById('totalDividend').textContent =
                'NT$ ' + totalDividend.toLocaleString();
            document.getElementById('monthlyDividend').textContent =
                'NT$ ' + monthlyDividend.toLocaleString();

            placeholder.style.display = 'none';
            results.style.display = 'block';
        }
    });
</script>
{% endblock %}